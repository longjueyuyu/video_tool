# 专业视频剪辑工具

一个功能强大的视频处理工具，主要使用ffmpeg处理剪切、合并、字幕功能，支持视频原画剪切、合并和字幕添加功能。采用图形化界面设计，操作简单直观。

# 功能截图如下
<img width="400" height="200" alt="image" src="https://github.com/user-attachments/assets/2a1a1b67-9143-4979-9663-c9254ee0d561" />
<img width="400" height="200" alt="image" src="https://github.com/user-attachments/assets/adfefd5e-b87d-460d-947b-bc7f53aa52d1" />
![Uploading image.png…]()



## 功能特性

### 1. 视频剪切
- 支持精确到毫秒级的视频剪切
- 可视化时间轴拖拽操作
- 实时预览功能
- 支持4K高分辨率视频处理
- 硬件加速支持（自动检测）

### 2. 视频合并
- 支持批量添加视频文件
- 拖放操作添加文件
- 自动检测最佳输出格式
- 保持原视频质量
- 实时进度显示

### 3. 字幕视频生成
- 支持SRT/ASS字幕格式
- 可自定义字体大小、颜色、位置
- GPU硬件加速支持（NVIDIA/Intel/AMD）
- 实时预览字幕效果
- 自动检测并使用原视频比特率
- 支持中途保存进度

## 系统要求

- **操作系统**: Windows 10/11, Linux, macOS
- **Python版本**: Python 3.7 或更高版本
- **FFmpeg**: 必须安装（详见安装说明）
- **内存**: 建议 8GB 以上
- **显卡**: 可选，支持硬件加速（NVIDIA/Intel/AMD）

## 安装说明

### 1. 安装Python依赖

```bash
pip install -r requirements.txt
```

### 2. 安装FFmpeg

#### Windows系统

**方法一：下载预编译版本**
1. 访问 [FFmpeg官网](https://ffmpeg.org/download.html)
2. 下载Windows版本
3. 解压到任意目录（如 `C:\ffmpeg`）
4. 将 `bin` 目录添加到系统环境变量 PATH

**方法二：使用包管理器（推荐）**
```bash
# 使用Chocolatey
choco install ffmpeg

# 或使用Scoop
scoop install ffmpeg
```

#### Linux系统

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install ffmpeg

# CentOS/RHEL
sudo yum install ffmpeg

# Arch Linux
sudo pacman -S ffmpeg
```

#### macOS系统

```bash
# 使用Homebrew
brew install ffmpeg
```

### 3. 验证FFmpeg安装

```bash
ffmpeg -version
```

如果显示版本信息，则安装成功。

## 使用说明

### 启动程序

```bash
python video.py
```

### 视频剪切功能

1. 点击"视频剪切"标签页
2. 拖放视频文件到预览区域，或点击区域选择文件
3. 拖动绿色（开始）和红色（结束）滑块选择剪切区间
4. 点击"开始剪辑"按钮
5. 剪切完成后会自动打开输出目录

**注意事项：**
- 支持的格式：MP4, AVI, MOV, MKV, FLV, TS, WMV
- 最小剪切时长：0.1秒
- 剪切时使用流复制模式，保持原视频质量

### 视频合并功能

1. 点击"视频合并"标签页
2. 通过以下方式添加视频：
   - 拖放多个视频文件到列表区域
   - 点击"添加视频"按钮选择文件
3. 使用"上移"/"下移"按钮调整视频顺序
4. 点击"合并选中视频"按钮
5. 选择保存位置和格式
6. 等待合并完成

**注意事项：**
- 至少需要添加2个视频文件
- 支持对列表排序（点击列标题）
- 合并使用流复制模式，速度快且无损质量
- 自动检测输出格式（所有输入格式一致时使用该格式，否则使用MP4）

### 字幕视频生成

1. 点击"字幕视频"标签页
2. 选择视频文件和字幕文件（SRT格式）
3. 自定义字幕样式：
   - **字号**：12-48号字体
   - **颜色**：12种预设颜色
   - **位置**：顶部/中间/底部
   - **GPU加速**：根据显卡选择
   - **比特率**：自动使用原视频比特率，可手动修改
4. 点击"预览字幕"查看效果
5. 点击"生成字幕视频"开始生成
6. 生成完成后会自动打开输出目录

**GPU加速选项说明：**
- **无GPU**：使用CPU软件编码（兼容性最好，速度较慢）
- **NVIDIA显卡**：使用h264_nvenc编码器（推荐）
- **NVIDIA高性能**：使用快速模式，速度最快
- **Intel集成显卡**：使用hevc_qsv编码器
- **AMD显卡**：使用av1_amf编码器
- **VAAPI**：Linux系统硬件加速

**注意事项：**
- 字幕文件必须与视频时长匹配
- 超出视频时长的字幕会被自动跳过或截断
- 生成过程中可点击"保存当前进度"按钮优雅退出
- 使用GPU加速可显著提高生成速度

## 技术特性

### 性能优化
- **智能预览**：使用FFmpeg快速截帧，支持8K视频流畅预览
- **硬件加速**：自动检测并使用可用的GPU编码器
- **流复制模式**：剪切和合并时避免重新编码，保持原画质
- **多线程处理**：界面和处理分离，不卡顿

### 进程管理
- **优雅退出**：关闭程序时自动保存视频进度
- **进程清理**：自动清理残留的FFmpeg进程
- **错误处理**：完善的异常处理机制

### 中文路径支持
- 完美支持包含中文和特殊字符的文件路径
- 正确处理Windows下的路径编码问题

## 支持的格式

### 视频格式
- MP4 (推荐)
- AVI
- MOV
- MKV
- FLV
- TS
- WMV

### 字幕格式
- SRT (SubRip)
- ASS (Advanced SubStation Alpha)
- SSA (SubStation Alpha)

## 常见问题

### Q: 提示找不到FFmpeg？
**A:** 请确保：
1. 已正确安装FFmpeg
2. FFmpeg已添加到系统PATH环境变量
3. 或将FFmpeg.exe放在程序同目录下的`ffmpeg/bin/`文件夹中

### Q: 视频预览显示黑屏？
**A:** 可能原因：
1. 视频文件损坏或格式不支持
2. 显卡驱动需要更新
3. 尝试更换视频文件测试

### Q: GPU加速选项无效？
**A:** 请检查：
1. 是否安装了对应显卡的驱动
2. FFmpeg是否编译了对应的硬件加速支持
3. 可以先使用"无GPU"选项测试

### Q: 生成字幕视频速度很慢？
**A:** 建议：
1. 使用GPU加速选项
2. 降低输出比特率
3. 确保硬盘有足够空间
4. 关闭其他占用资源的程序

### Q: 中文路径无法识别？
**A:** 本程序已优化中文路径支持，如仍有问题：
1. 尝试将视频移到英文路径下
2. 确保使用UTF-8编码
3. 检查文件名是否包含特殊符号

### Q: 合并视频失败？
**A:** 检查项：
1. 所有视频是否都能正常播放
2. 视频格式是否兼容（建议先统一转换为MP4）
3. 硬盘空间是否充足
4. 查看控制台输出的错误信息

## 项目结构

```
video_cut/
├── video.py              # 主程序文件
├── requirements.txt      # Python依赖列表
├── README.md            # 说明文档
└── ffmpeg/              # FFmpeg可执行文件目录（可选）
    └── bin/
        ├── ffmpeg.exe   # Windows
        └── ffprobe.exe
```

## 开发说明

### 主要模块
- `VideoTrimmerPro`: 主应用类
- `create_widgets()`: 创建GUI界面
- `load_video()`: 加载视频文件
- `merge_videos()`: 视频合并功能
- `generate_subtitle_video()`: 字幕视频生成

### 核心依赖
- **tkinter**: GUI框架
- **tkinterdnd2**: 拖放功能支持
- **OpenCV**: 视频读取和预览
- **Pillow**: 图像处理
- **FFmpeg**: 底层视频处理引擎

## 许可证

本项目仅供学习和个人使用。

## 技术支持

如遇到问题，请：
1. 查看控制台输出的详细错误信息
2. 确认FFmpeg安装正确
3. 检查视频文件是否完整

## 更新日志

### v1.0.0 (当前版本)
- ✅ 视频剪切功能
- ✅ 视频合并功能
- ✅ 字幕视频生成
- ✅ GPU硬件加速支持
- ✅ 8K视频支持
- ✅ 中文路径支持
- ✅ 优雅进程管理
- ✅ 实时进度显示

## 鸣谢

- FFmpeg项目提供的强大视频处理能力
- Python开源社区的各项优秀库
- 希望大家一起增加完善

---

**注意**: 本工具处理大型视频文件时可能需要较长时间，请耐心等待。建议在处理前确保硬盘有足够的可用空间。

